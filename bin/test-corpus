#!/usr/bin/env bash

set -e

while [[ $# -gt 0 ]]; do
  case $1 in
  --force)
    FORCE="--force"
    shift
    ;;

  *)
    break
    ;;
  esac
done

printf "\033[1mRunning Tree-sitter tests...\033[0m\n"

bin/generate-parser $FORCE
bin/generate-corpus $FORCE

npx tree-sitter test

printf "\033[1mGetting Hacklang errors...\033[0m\n"

bin/get-errors hack test/cases/**/*.php
