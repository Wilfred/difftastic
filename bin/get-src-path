#!/usr/bin/env ruby
# frozen_string_literal: true

# Given a path to a file containing the s-expression output of bin/parse, print the
# corresponding source file. Print the source file if given a source file.
#
# This simple script is useful in VSCode so we can quickly re-parse Hacklang code without
# having to switch windows.

ARGV.each do |path|
  next puts path if path =~ /\.(php|hack)$/

  base = path.gsub(/(\.ts|\.hh)?\.exp/, '')

  next puts "#{base}.php" if File.exist?("#{base}.php")
  next puts "#{base}.hack" if File.exist?("#{base}.hack")

  warn "Corresponding Hack file not found for #{path}"
  exit 1
end
